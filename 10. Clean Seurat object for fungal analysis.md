## Create a clean filtered object with the RNA experiment
```R
# Get the filtered Seurat object
obj <- j_obj_95_outliers_Z2.5
   
# Extract RNA counts and metadata
counts <- GetAssayData(obj, assay = "RNA", layer = "counts")
metadata <- obj@meta.data
cols_to_keep <- c("orig.ident","nCount_RNA","nFeature_RNA","Sample","Treatment","sample","nCount_fungal",
                  "nFeature_fungal","percent_fungal","percent_fungal_features")

metadata <- metadata[, intersect(cols_to_keep, colnames(metadata)), drop = FALSE]
   
# Create a clean Seurat object
j_obj_95_clean <- CreateSeuratObject(counts = counts, meta.data = metadata)
```


## Subset the count maxis to keep only fungal genes

```R
# Define pattern to match fungal gene names
fungal_pattern <- "^gene-HI914"

# Get seurat object
obj <- j_obj_95_clean
   
# Extract fungal genes present in the counts matrix
counts <- GetAssayData(obj, assay = "RNA", layer = "counts")
fungal_genes <- grep(fungal_pattern, rownames(counts), value = TRUE)
   
# Subset the counts matrix to keep fungal genes only
filtered_counts <- counts[fungal_genes, , drop = FALSE]
   
# Recreate RNA assay with only fungal counts
fungal_assay <- CreateAssay5Object(counts = filtered_counts)
   
# Replace the RNA assay
obj[["RNA"]] <- fungal_assay
   
# Save back
assign(j_obj_95_clean, obj)

# Confirm total  number of nuclei 
table(j_obj_95_clean$Treatment)
# Inf_1DPI Inf_5DPI
# 191     3028
```
